<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blaze Analyzer - Tela Completa</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
            height: 100vh;
            background: #0a0e27;
        }

        /* Container principal */
        .split-container {
            display: flex;
            height: 100vh;
            width: 100vw;
        }

        /* Painel de anÃ¡lise (esquerda) */
        .analysis-panel {
            width: 380px;
            min-width: 320px;
            max-width: 500px;
            background: linear-gradient(135deg, #1a1f3a 0%, #0a0e27 100%);
            border-right: 2px solid #ff003f;
            overflow-y: auto;
            overflow-x: hidden;
            box-shadow: 2px 0 20px rgba(255, 0, 63, 0.3);
            position: relative;
            z-index: 10;
        }

        /* Scrollbar customizada */
        .analysis-panel::-webkit-scrollbar {
            width: 8px;
        }

        .analysis-panel::-webkit-scrollbar-track {
            background: #0a0e27;
        }

        .analysis-panel::-webkit-scrollbar-thumb {
            background: #ff003f;
            border-radius: 4px;
        }

        .analysis-panel::-webkit-scrollbar-thumb:hover {
            background: #ff1a4d;
        }

        /* Site da Blaze (direita) */
        .blaze-site {
            flex: 1;
            position: relative;
            background: #000;
        }

        .blaze-iframe {
            width: 100%;
            height: 100%;
            border: none;
            display: block;
        }

        /* Header do painel */
        .panel-header {
            background: linear-gradient(135deg, #ff003f 0%, #c40032 100%);
            padding: 20px;
            text-align: center;
            box-shadow: 0 4px 12px rgba(255, 0, 63, 0.4);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .panel-title {
            color: white;
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        .panel-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 14px;
            font-weight: 500;
        }

        /* ConteÃºdo do painel */
        .panel-content {
            padding: 20px;
        }

        /* Aviso de carregamento do iframe */
        .iframe-loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            z-index: 5;
        }

        .loading-spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 0, 63, 0.2);
            border-top: 4px solid #ff003f;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Mensagem de erro se iframe for bloqueado */
        .iframe-blocked {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            color: white;
            background: rgba(10, 14, 39, 0.95);
            padding: 40px;
            border-radius: 16px;
            border: 2px solid #ff003f;
            max-width: 500px;
            display: none;
            z-index: 10;
        }

        .iframe-blocked h2 {
            color: #ff003f;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .iframe-blocked p {
            color: #a8a8a8;
            font-size: 16px;
            margin-bottom: 24px;
            line-height: 1.6;
        }

        .iframe-blocked button {
            background: linear-gradient(135deg, #ff003f 0%, #c40032 100%);
            color: white;
            border: none;
            padding: 12px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .iframe-blocked button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(255, 0, 63, 0.4);
        }

        /* Responsivo - Mobile */
        @media (max-width: 768px) {
            .split-container {
                flex-direction: column;
            }

            .analysis-panel {
                width: 100%;
                max-width: 100%;
                height: 50vh;
                border-right: none;
                border-bottom: 2px solid #ff003f;
            }

            .blaze-site {
                height: 50vh;
            }

            .mobile-warning {
                display: none !important;
            }
        }

        /* Aviso para mobile */
        .mobile-warning {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            background: #0a0e27;
            z-index: 9999;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            padding: 20px;
            text-align: center;
        }

        .mobile-warning.active {
            display: flex;
        }

        .mobile-warning-icon {
            font-size: 64px;
            margin-bottom: 20px;
        }

        .mobile-warning h2 {
            color: #ff003f;
            font-size: 24px;
            margin-bottom: 16px;
        }

        .mobile-warning p {
            color: #a8a8a8;
            font-size: 16px;
            margin-bottom: 24px;
            max-width: 400px;
        }

        .mobile-warning button {
            background: linear-gradient(135deg, #ff003f 0%, #c40032 100%);
            color: white;
            border: none;
            padding: 12px 32px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        /* Resize handle (divisor) */
        .resize-handle {
            width: 6px;
            background: #ff003f;
            cursor: col-resize;
            position: relative;
            transition: background 0.2s ease;
        }

        .resize-handle:hover {
            background: #ff1a4d;
        }

        .resize-handle::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 20px;
            height: 60px;
            background: rgba(255, 0, 63, 0.2);
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <!-- Aviso para Mobile (apenas se forÃ§ar acesso mobile) -->
    <div class="mobile-warning" id="mobileWarning">
        <div class="mobile-warning-icon">ğŸ“±</div>
        <h2>Recurso DisponÃ­vel Apenas no Desktop</h2>
        <p>A tela dividida funciona melhor em computadores. Use a extensÃ£o normal no celular para uma experiÃªncia otimizada.</p>
        <button onclick="window.close()">Fechar</button>
    </div>

    <!-- Container principal -->
    <div class="split-container">
        <!-- Painel de anÃ¡lise (esquerda) -->
        <div class="analysis-panel" id="analysisPanel">
            <div class="panel-header">
                <h1 class="panel-title">ğŸ¯ Blaze Analyzer</h1>
                <p class="panel-subtitle">AnÃ¡lise em Tempo Real</p>
            </div>
            <div class="panel-content" id="panelContent">
                <!-- ConteÃºdo serÃ¡ carregado via JavaScript -->
            </div>
        </div>

        <!-- Divisor redimensionÃ¡vel -->
        <div class="resize-handle" id="resizeHandle"></div>

        <!-- Site da Blaze (direita) -->
        <div class="blaze-site" id="blazeSite">
            <div class="iframe-loading" id="iframeLoading">
                <div class="loading-spinner"></div>
                <p style="font-size: 16px; color: #a8a8a8;">Carregando Blaze...</p>
            </div>

            <iframe 
                id="blazeIframe"
                class="blaze-iframe" 
                src="https://blaze.bet.br/pt/"
                sandbox="allow-same-origin allow-scripts allow-forms allow-popups allow-popups-to-escape-sandbox"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                loading="eager">
            </iframe>

            <div class="iframe-blocked" id="iframeBlocked">
                <h2>âš ï¸ Site Bloqueado</h2>
                <p>O site da Blaze bloqueou o carregamento no iframe por razÃµes de seguranÃ§a.</p>
                <p><strong>SoluÃ§Ã£o:</strong> Clique no botÃ£o abaixo para abrir o site em uma nova janela ao lado.</p>
                <button onclick="openBlazeInNewWindow()">ğŸš€ Abrir Blaze em Nova Janela</button>
            </div>
        </div>
    </div>

    <script>
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // DETECTAR MOBILE E MOSTRAR AVISO
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        function isMobile() {
            return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) 
                || window.innerWidth < 768;
        }

        if (isMobile()) {
            document.getElementById('mobileWarning').classList.add('active');
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // CARREGAR CONTEÃšDO DA EXTENSÃƒO NO PAINEL
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        async function loadExtensionContent() {
            try {
                // Buscar dados do chrome.storage
                const data = await new Promise((resolve) => {
                    chrome.storage.local.get([
                        'lastSpin',
                        'currentAnalysis',
                        'isAnalyzing',
                        'hitRate',
                        'patternHistory',
                        'userData'
                    ], resolve);
                });

                renderContent(data);

                // Atualizar a cada 3 segundos
                setInterval(async () => {
                    const updatedData = await new Promise((resolve) => {
                        chrome.storage.local.get([
                            'lastSpin',
                            'currentAnalysis',
                            'isAnalyzing',
                            'hitRate',
                            'patternHistory'
                        ], resolve);
                    });
                    renderContent(updatedData);
                }, 3000);

            } catch (error) {
                console.error('Erro ao carregar conteÃºdo:', error);
                document.getElementById('panelContent').innerHTML = `
                    <div style="padding: 20px; text-align: center; color: #ff003f;">
                        <p style="font-size: 18px; font-weight: 600; margin-bottom: 12px;">âš ï¸ Erro ao Conectar</p>
                        <p style="color: #a8a8a8; font-size: 14px;">Certifique-se de que a extensÃ£o estÃ¡ instalada e ativa.</p>
                        <button onclick="location.reload()" style="margin-top: 20px; background: #ff003f; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer;">
                            ğŸ”„ Recarregar
                        </button>
                    </div>
                `;
            }
        }

        function renderContent(data) {
            const content = document.getElementById('panelContent');
            
            // Ãšltimo giro
            const lastSpin = data.lastSpin || { color: 'Aguardando...', number: '?', time: '-' };
            
            // AnÃ¡lise atual
            const analysis = data.currentAnalysis || null;
            const isAnalyzing = data.isAnalyzing || false;
            
            // Taxa de acerto
            const hitRate = data.hitRate || { hits: 0, total: 0, percentage: 0 };
            
            // HistÃ³rico de padrÃµes
            const patterns = data.patternHistory || [];

            let html = `
                <!-- Ãšltimo Giro -->
                <div style="background: linear-gradient(135deg, #1a1f3a 0%, #0f1229 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(255, 0, 63, 0.2);">
                    <h3 style="color: white; font-size: 16px; margin-bottom: 12px; text-align: center;">ğŸ° Ãšltimo Giro</h3>
                    <div style="display: flex; align-items: center; justify-content: center; gap: 16px;">
                        <div style="width: 60px; height: 60px; border-radius: 50%; background: ${getColorBg(lastSpin.color)}; display: flex; align-items: center; justify-content: center; font-size: 24px; font-weight: 700; color: white; box-shadow: 0 4px 12px ${getColorShadow(lastSpin.color)};">
                            ${lastSpin.number}
                        </div>
                        <div>
                            <div style="color: ${getColorText(lastSpin.color)}; font-size: 18px; font-weight: 600;">${lastSpin.color}</div>
                            <div style="color: #a8a8a8; font-size: 13px;">${lastSpin.time}</div>
                        </div>
                    </div>
                </div>

                <!-- Taxa de Acerto -->
                <div style="background: linear-gradient(135deg, #1a1f3a 0%, #0f1229 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(255, 0, 63, 0.2);">
                    <h3 style="color: white; font-size: 16px; margin-bottom: 12px; text-align: center;">ğŸ“Š Acertos: ${hitRate.hits}/${hitRate.total} (${hitRate.percentage}%)</h3>
                    <div style="background: #0a0e27; height: 12px; border-radius: 6px; overflow: hidden;">
                        <div style="height: 100%; background: linear-gradient(90deg, #00ff88 0%, #00cc6a 100%); width: ${hitRate.percentage}%; transition: width 0.5s ease;"></div>
                    </div>
                </div>
            `;

            // AnÃ¡lise atual
            if (isAnalyzing) {
                html += `
                    <div style="background: linear-gradient(135deg, #2a2f4a 0%, #1a1f3a 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(255, 200, 0, 0.3);">
                        <h3 style="color: #ffc107; font-size: 16px; margin-bottom: 12px; text-align: center;">â³ Aguardando Novo Giro...</h3>
                        <div style="text-align: center;">
                            <div style="width: 40px; height: 40px; border: 4px solid rgba(255, 193, 7, 0.2); border-top: 4px solid #ffc107; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
                        </div>
                    </div>
                `;
            } else if (analysis) {
                html += `
                    <div style="background: linear-gradient(135deg, #1a3a1f 0%, #0f291f 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 2px solid rgba(0, 255, 136, 0.3); box-shadow: 0 4px 20px rgba(0, 255, 136, 0.2);">
                        <h3 style="color: #00ff88; font-size: 18px; margin-bottom: 16px; text-align: center; font-weight: 700;">ğŸ¯ SINAL DETECTADO!</h3>
                        
                        <div style="background: rgba(0, 255, 136, 0.1); padding: 16px; border-radius: 8px; margin-bottom: 16px; text-align: center;">
                            <div style="color: #a8a8a8; font-size: 12px; margin-bottom: 8px;">APOSTAR EM:</div>
                            <div style="color: ${getColorText(analysis.suggestedColor)}; font-size: 32px; font-weight: 700; text-transform: uppercase;">
                                ${analysis.suggestedColor}
                            </div>
                        </div>

                        <div style="color: #a8a8a8; font-size: 14px; line-height: 1.6; margin-bottom: 12px;">
                            ${analysis.reasoning || 'AnÃ¡lise baseada em padrÃµes detectados.'}
                        </div>

                        <div style="background: rgba(0, 0, 0, 0.3); padding: 12px; border-radius: 8px; margin-bottom: 12px;">
                            <div style="color: #a8a8a8; font-size: 12px; margin-bottom: 8px;">ğŸ“Š Ãšltimos 10 Giros:</div>
                            <div style="display: flex; gap: 6px; flex-wrap: wrap;">
                                ${(analysis.last10Spins || []).map(spin => `
                                    <div style="width: 30px; height: 30px; border-radius: 50%; background: ${getColorBg(spin.color)}; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 600; color: white;">
                                        ${spin.number}
                                    </div>
                                `).join('')}
                            </div>
                        </div>

                        <div style="text-align: center; color: #00ff88; font-size: 13px; font-weight: 600;">
                            â° ${new Date(analysis.timestamp).toLocaleTimeString('pt-BR')}
                        </div>
                    </div>
                `;
            } else {
                html += `
                    <div style="background: linear-gradient(135deg, #1a1f3a 0%, #0f1229 100%); padding: 20px; border-radius: 12px; margin-bottom: 20px; border: 1px solid rgba(255, 0, 63, 0.2); text-align: center;">
                        <p style="color: #a8a8a8; font-size: 14px;">Nenhum padrÃ£o detectado ainda...</p>
                    </div>
                `;
            }

            // HistÃ³rico de padrÃµes
            if (patterns.length > 0) {
                html += `
                    <div style="background: linear-gradient(135deg, #1a1f3a 0%, #0f1229 100%); padding: 20px; border-radius: 12px; border: 1px solid rgba(255, 0, 63, 0.2);">
                        <h3 style="color: white; font-size: 16px; margin-bottom: 12px;">ğŸ“œ HistÃ³rico de Entradas</h3>
                        <div style="max-height: 300px; overflow-y: auto;">
                            ${patterns.slice(0, 10).map(p => `
                                <div style="background: rgba(255, 255, 255, 0.05); padding: 12px; border-radius: 8px; margin-bottom: 8px; border-left: 3px solid ${p.hit ? '#00ff88' : '#ff003f'};">
                                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                        <span style="color: white; font-weight: 600;">${p.suggestedColor}</span>
                                        <span style="color: ${p.hit ? '#00ff88' : '#ff003f'}; font-size: 18px;">${p.hit ? 'âœ…' : 'âŒ'}</span>
                                    </div>
                                    <div style="color: #a8a8a8; font-size: 12px;">${new Date(p.timestamp).toLocaleString('pt-BR')}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }

            content.innerHTML = html;
        }

        function getColorBg(color) {
            const colors = {
                'Vermelho': '#e74c3c',
                'Preto': '#2c3e50',
                'Branco': '#ecf0f1'
            };
            return colors[color] || '#34495e';
        }

        function getColorShadow(color) {
            const shadows = {
                'Vermelho': 'rgba(231, 76, 60, 0.4)',
                'Preto': 'rgba(44, 62, 80, 0.4)',
                'Branco': 'rgba(236, 240, 241, 0.4)'
            };
            return shadows[color] || 'rgba(52, 73, 94, 0.4)';
        }

        function getColorText(color) {
            const textColors = {
                'Vermelho': '#e74c3c',
                'Preto': '#ffffff',
                'Branco': '#ecf0f1'
            };
            return textColors[color] || '#a8a8a8';
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // GERENCIAR IFRAME DA BLAZE
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const blazeIframe = document.getElementById('blazeIframe');
        const iframeLoading = document.getElementById('iframeLoading');
        const iframeBlocked = document.getElementById('iframeBlocked');

        blazeIframe.addEventListener('load', () => {
            setTimeout(() => {
                iframeLoading.style.display = 'none';
            }, 1000);
        });

        // Detectar se o iframe foi bloqueado
        blazeIframe.addEventListener('error', () => {
            iframeLoading.style.display = 'none';
            iframeBlocked.style.display = 'block';
        });

        // Verificar apÃ³s 5 segundos se carregou
        setTimeout(() => {
            try {
                const iframeDoc = blazeIframe.contentDocument || blazeIframe.contentWindow.document;
                if (!iframeDoc.body || iframeDoc.body.innerHTML === '') {
                    iframeLoading.style.display = 'none';
                    iframeBlocked.style.display = 'block';
                }
            } catch (e) {
                // Se der erro de acesso, provavelmente foi bloqueado
                console.log('Iframe pode estar bloqueado:', e);
            }
        }, 5000);

        function openBlazeInNewWindow() {
            window.open('https://blaze.bet.br/pt/', '_blank', 'width=1200,height=800');
            iframeBlocked.style.display = 'none';
            blazeIframe.style.display = 'none';
        }

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // REDIMENSIONAR PAINEL (ARRASTAR DIVISOR)
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        const resizeHandle = document.getElementById('resizeHandle');
        const analysisPanel = document.getElementById('analysisPanel');
        let isResizing = false;

        resizeHandle.addEventListener('mousedown', (e) => {
            isResizing = true;
            document.body.style.cursor = 'col-resize';
        });

        document.addEventListener('mousemove', (e) => {
            if (!isResizing) return;
            
            const newWidth = e.clientX;
            if (newWidth >= 320 && newWidth <= 600) {
                analysisPanel.style.width = newWidth + 'px';
            }
        });

        document.addEventListener('mouseup', () => {
            isResizing = false;
            document.body.style.cursor = 'default';
        });

        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        // INICIALIZAR
        // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
        
        if (!isMobile()) {
            loadExtensionContent();
        }
    </script>
</body>
</html>

